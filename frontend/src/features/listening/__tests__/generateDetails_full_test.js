import { generateDetailsFromSections } from '../pages/ListeningResults';

// Test data copied from user's JSON (simplified into JS structure)
const testData = {
  partInstructions: JSON.parse('[{"title":"Part 1","instruction":"","transcript":"","audioFile":"/uploads/audio/1769176488238-845740179.mp3","sections":[{"sectionTitle":"Questions 1-10","sectionInstruction":"Complete the notes below.\\nWrite ONE WORD AND/OR A NUMBER for each answer.","questionType":"notes-completion","startingQuestionNumber":null}]},{"title":"Part 2","instruction":"","transcript":"","audioFile":"/uploads/audio/1769176488238-845740179.mp3","sections":[{"sectionTitle":"Questions 11-14","sectionInstruction":"Choose the correct letter, A, B or C.","questionType":"abc","startingQuestionNumber":null},{"sectionTitle":"Questions 15-20","sectionInstruction":"Questions 15-20 What information does the speaker give about each of the following areas of\\nthe museum?\\nChoose SIX answers from the box and write the correct letter, A-H, next to Questions 15-20.","questionType":"matching","startingQuestionNumber":null}]},{"title":"Part 3","instruction":"","transcript":"","audioFile":"/uploads/audio/1769176488238-845740179.mp3","sections":[{"sectionTitle":"Questions 21-22","sectionInstruction":"Choose TWO letters, A-E.\\n","questionType":"multi-select","startingQuestionNumber":null},{"sectionTitle":"Questions 23-27","sectionInstruction":"Which comment do the students make about each of the following children in\\nthe video?\\nChoose FIVE answers from the box and write the correct letter, A-G, next to Questions 23-27.","questionType":"matching","startingQuestionNumber":null},{"sectionTitle":"Questions 28-30","sectionInstruction":"Choose the correct letter, A, B or C.","questionType":"abc","startingQuestionNumber":null}]},{"title":"Part 4","instruction":"","transcript":"","audioFile":"/uploads/audio/1769176488238-845740179.mp3","sections":[{"sectionTitle":"Questions 31-40","sectionInstruction":"Complete the notes below.\\nWrite ONE WORD ONLY for each answer","questionType":"notes-completion","startingQuestionNumber":null}]}]'),
  questions: JSON.parse('[{"partIndex":0,"sectionIndex":0,"questionIndex":0,"globalNumber":1,"questionType":"fill","questionText":"","correctAnswer":"","options":[],"formTitle":null,"formRows":[],"questionRange":null,"answers":{"1":"receptionist","2":"Medical","3":"Chastons","4":"appointments","5":"database","6":"experience","7":"confident","8":"temporary","9":"1.15","10":"parking"},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":"Role 1………….\\nLocation Fordham 2…………………. Centre\\n3…………………. Road, Fordham\\nWork involves\\n● dealing with enquiries\\n● making 4…………………. and reorganising them\\n● maintaining the internal 5………………….\\n● general administration\\nRequirements\\n● 6…………………. (essential)\\n● a calm and 7…………………. manner\\n● good IT skills\\nOther information\\n● a 8…………………. job – further opportunities may be available\\n● hours: 7.45 a.m. to 9…………………. p.m. Monday to Friday\\n● 10…………………. is available onsite","notesTitle":"Job details from employment agency","requiredAnswers":2},{"partIndex":1,"sectionIndex":0,"questionIndex":0,"globalNumber":2,"questionType":"fill","questionText":"The museum building was originally","correctAnswer":"B","options":["A. a factory","B. a private home.","C. a hall of residence."],"formTitle":null,"formRows":[],"questionRange":null,"answers":{},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":1,"sectionIndex":0,"questionIndex":1,"globalNumber":3,"questionType":"abc","questionText":"The university uses part of the museum building as","correctAnswer":"A","options":["A. teaching rooms.","B. a research library.","C. administration offices."],"formTitle":null,"formRows":[],"questionRange":null,"answers":{},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":1,"sectionIndex":0,"questionIndex":2,"globalNumber":4,"questionType":"abc","questionText":"What does the guide say about the entrance fee?","correctAnswer":"A","options":["A. Visitors decide whether or not they wish to pay.","B. Only children and students receive a discount.","C. The museum charges extra for special exhibitions."],"formTitle":null,"formRows":[],"questionRange":null,"answers":{},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":1,"sectionIndex":0,"questionIndex":3,"globalNumber":5,"questionType":"abc","questionText":"What are visitors advised to leave in the cloakroom?","correctAnswer":"C","options":["A. cameras","B. coats","C. bags"],"formTitle":null,"formRows":[],"questionRange":null,"answers":{},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":1,"sectionIndex":1,"questionIndex":0,"globalNumber":6,"questionType":"fill","questionText":"","correctAnswer":"","options":[],"formTitle":null,"formRows":[],"questionRange":null,"answers":{"15":"F","16":"G","17":"E","18":"A","19":"C","20":"B"},"leftItems":["Four Seasons","Farmhouse Kitchen","A Year on the Farm","Wagon Walk","Bees are Magic","The Pond"],"rightItems":["A. Parents must supervise their children.","B. There are new things to see.","C. It is closed today.","D. This is only for school groups.","E. There is a quiz for visitors.","F. it features something created by students.","G. An expert is here today.","H. There is a one-way system."],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":2,"sectionIndex":0,"questionIndex":0,"globalNumber":7,"questionType":"fill","questionText":"Which TWO educational skills were shown in the video of children doing origami?","correctAnswer":"B,D","options":["A. solving problems","B. following instructions","C. working cooperatively","D. learning through play","E. developing hand-eye coordination"],"formTitle":null,"formRows":[],"questionRange":null,"answers":{},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":2,"sectionIndex":1,"questionIndex":0,"globalNumber":8,"questionType":"fill","questionText":"","correctAnswer":"","options":[],"formTitle":null,"formRows":[],"questionRange":null,"answers":{"23":"D","24":"A","25":"C","26":"G","27":"F"},"leftItems":["Sid","Jack","Naomi","Anya","Zara"],"rightItems":["A. demonstrated independence","B. asked for teacher support","C. developed a competitive attitude","D. seemed to find the activity calming","E. seemed pleased with the results","F. seemed confused","G. seemed to find the activity easy"],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":2,"sectionIndex":2,"questionIndex":0,"globalNumber":9,"questionType":"fill","questionText":"Before starting an origami activity in class, the students think it is important for the teacher to","correctAnswer":"A","options":["A. make models that demonstrate the different stages.","B. check children understand the terminology involved.","C. tell children not to worry if they find the activity difficult."],"formTitle":null,"formRows":[],"questionRange":null,"answers":{},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":2,"sectionIndex":2,"questionIndex":1,"globalNumber":10,"questionType":"abc","questionText":"The students agree that some teachers might be unwilling to use origami in class because","correctAnswer":"B","options":["A. they may not think that crafts are important.","B. they may not have the necessary skills.","C. they may worry that it will take up too much time."],"formTitle":null,"formRows":[],"questionRange":null,"answers":{},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":2,"sectionIndex":2,"questionIndex":2,"globalNumber":11,"questionType":"abc","questionText":"Why do the students decide to use origami in their maths teaching practice?","correctAnswer":"C","options":["A. to correct a particular misunderstanding","B. to set a challenge","C. to introduce a new concept"],"formTitle":null,"formRows":[],"questionRange":null,"answers":{},"leftItems":[],"rightItems":[],"items":[],"wordLimit":null,"notesText":null,"notesTitle":null,"requiredAnswers":2},{"partIndex":3,"sectionIndex":0,"questionIndex":0,"globalNumber":12,"questionType":"fill","questionText":"","correctAnswer":"","options":null,"formTitle":null,"formRows":null,"questionRange":null,"answers":{"31":"plot","32":"poverty","33":"Europe","34":"poetry","35":"drawings","36":"furniture","37":"lamps","38":"harbour | harbor","39":"children","40":"relatives"},"leftItems":null,"rightItems":null,"items":null,"wordLimit":null,"notesText":"His novel, Les Misérables\\n● It has been adapted for theatre and cinema.\\n● We know more about its overall 31………………. than about its author.\\nHis early career\\n● In Paris, his career was successful and he led the Romantic movement.\\n● He spoke publicly about social issues, such as 32………………. and education.\\n● Napoleon III disliked his views and exiled him.\\nHis exile from France\\n● Victor Hugo had to live elsewhere in 33……………….\\n● He used his income from the sale of some 34………………. he had written to buy a house\\non Guernsey.\\nHis house on Guernsey\\n● Victor Hugo lived in this house until the end of the Empire in France.\\n● The ground floor contains portraits, 35………………. and tapestries that he valued.\\n● He bought cheap 36………………. made of wood and turned this into beautiful wall\\ncarvings.\\n● The first floor consists of furnished areas with wallpaper and 37………………. that have a\\nChinese design.\\n● The library still contains many of his favourite books.\\n● He wrote in a room at the top of the house that had a view of the 38………………. .\\n● He entertained other writers as well as poor 39………………. in his house.\\n● Victor Hugo’s 40………………. gave ownership of the house to the city of Paris in 1927.","notesTitle":"Victor Hugo","requiredAnswers":null}]')
};

describe('generateDetailsFromSections - full test data', () => {
  test('returns 40 detail rows for full test structure (total 40)', () => {
    const details = generateDetailsFromSections(testData, {});
    expect(details.length).toBe(40);
  });
});